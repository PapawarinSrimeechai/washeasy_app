{"version":3,"sources":["../../src/pages/top-up-machine/top-up-machine.module.ts","../../src/pages/top-up-machine/top-up-machine.ts"],"names":[],"mappings":"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","file":"0.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { TopUpMachinePage } from './top-up-machine';\nimport { HttpClientModule, HttpClient } from '@angular/common/http';\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\nimport { IonicStorageModule } from '@ionic/storage';\n\nexport function HttpLoaderFactory(http: HttpClient) {\n  return new TranslateHttpLoader(http);\n}\n@NgModule({\n  declarations: [\n    TopUpMachinePage,\n  ],\n  imports: [\n    IonicPageModule.forChild(TopUpMachinePage),\n    HttpClientModule,\n    TranslateModule.forRoot({\n      loader: {\n        provide: TranslateLoader,\n        useFactory: HttpLoaderFactory,\n        deps: [HttpClient]\n      }\n    }),\n    IonicStorageModule.forRoot()\n  ],\n})\nexport class TopUpMachinePageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/top-up-machine/top-up-machine.module.ts","import { Component } from '@angular/core';\nimport { IonicPage, NavController, NavParams, AlertController } from 'ionic-angular';\nimport { AngularFireAuth } from \"angularfire2/auth\";\nimport { BarcodeScanner, BarcodeScannerOptions } from \"@ionic-native/barcode-scanner\";\nimport { MessageServiceProvider } from '../../providers/message-service/message-service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Storage } from '@ionic/storage';\n/**\n * Generated class for the TopUpMachinePage page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\n\n@IonicPage()\n@Component({\n  selector: 'page-top-up-machine',\n  templateUrl: 'top-up-machine.html',\n})\nexport class TopUpMachinePage {\n  public getLang;\n  constructor(private barcode: BarcodeScanner, public navCtrl: NavController, public navParams: NavParams,\n    private afAuth : AngularFireAuth, private alertCtrl: AlertController, private msgService: MessageServiceProvider\n    ,private translate: TranslateService,private storage: Storage) {\n      this.storage.get('lang').then((data)=>{\n        this.translate.setDefaultLang(data);\n        this.translate.use(data);\n      });\n      this.translate.setTranslation('en', {\n        title: 'Top up by coin machine',\n        scan: 'Scan QR Code for coin',\n      });\n      this.translate.setTranslation('th', {\n        title: 'เติมเงินผ่านกล่องหยอดเหรียญ',\n        scan: 'สแกนเพื่อหยอดเหรียญ',\n       });\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad TopUpMachinePage');\n  }\n\n  price = 20;\n\n  scanBarcode() {\n    try {\n      this.afAuth.authState.take(1).subscribe(data => {\n        this.barcode.scan().then((barcodeData) => {\n            console.log(barcodeData);\n            var tmp = String(barcodeData.text);\n            var washingId = tmp.split(',',2);\n            if(washingId[0]!=undefined && washingId[1]!=undefined) {\n            //this.navCtrl.setRoot('TopUpMachine2Page',{token: data.uid, idWashing: washingId[0], idDorm: washingId[1]});\n              this.showAlert(data.uid, washingId[0], washingId[1]);\n            }\n          \n        }, (err) => {\n          //this.navCtrl.setRoot('TopUpMachine2Page',{token: data.uid, idWashing: 'W4000200101', idDorm: 'D40002001'});\n          this.showAlert(data.uid, 'W4000200101', 'D40002001');\n        });\n      });\n\n    } catch (error) {\n      console.error('scanBarcode ERROR: '+error);\n    }\n  }\n\n  showAlert(_token, _idWashing, _idDorm) {\n    let alert = this.alertCtrl.create({\n      title: 'Are you sure you want to top-up?',\n      subTitle: '',\n      buttons: [\n        {\n          text: 'OK',\n          handler: () => {\n            this.msgService.topUpRequest({token: _token, idWashing: _idWashing, idDorm: _idDorm}).subscribe(data => {\n              if(data.status==1){\n                this.navCtrl.setRoot('TopUpMachine2Page',{token: _token, idWashing: _idWashing, idDorm: _idDorm});\n              }else if(data.status==0){\n                this.showError();\n              }\n            });\n            console.log('ok clicked');\n          }\n        },\n        {\n          text: 'Cancel',\n          handler: () => {\n            console.log('cancel clicked');\n          }\n        }\n      ]\n    });\n    alert.present();\n  }\n\n  showError() {\n      if(this.getLang=='en'){\n        let alert = this.alertCtrl.create({\n          title: 'Can not make transaction',\n          subTitle: 'Please try again',\n          buttons: [\n            {\n              text: 'OK',\n              handler: () => {\n                console.log('ok clicked');\n              }\n            }\n          ]\n        });\n        alert.present();\n      }else if(this.getLang=='th'){\n        let alert = this.alertCtrl.create({\n          title: 'ไม่สามารถทำรายการได้',\n          subTitle: 'กรุณาลองใหม่อีกครั้ง',\n          buttons: [\n            {\n              text: 'ตกลง',\n              handler: () => {\n                console.log('ok clicked');\n              }\n            }\n          ]\n        });\n        alert.present();\n      }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/top-up-machine/top-up-machine.ts"],"sourceRoot":""}